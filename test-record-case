EIP-712 ç­¾åæµ‹è¯•æˆåŠŸæ¡ˆä¾‹è®°å½•
=====================================

ğŸ“… åˆ›å»ºæ—¶é—´: 2024-06-16
ğŸ¯ ç›®çš„: è®°å½•è”è°ƒè¿‡ç¨‹ä¸­æˆåŠŸçš„ç­¾åæ¡ˆä¾‹ï¼Œä¾¿äºåç»­å‚è€ƒå’Œå¤ç°

=======================================
âœ… æµ‹è¯•æ¡ˆä¾‹ #1 - AuthTransfer æƒé™ç­¾å
=======================================

ğŸ“‹ æ¡ˆä¾‹æè¿°: 
- ç±»å‹: Permits æƒé™æˆæƒç­¾å
- åˆçº¦: AuthTransfer
- é“¾: Ethereum Mainnet (chainId: 1)

ğŸ“„ æˆåŠŸçš„JSONæ•°æ®:
{
  "domain": {
    "name": "AuthTransfer",
    "chainId": 1,
    "verifyingContract": "0x40aA958dd87FC8305b97f2BA922CDdCa374bcD7f"
  },
  "message": {
    "details": [
      {
        "token": "0x0000000000000000000000000000000000000000",
        "expiration": 3242342
      }
    ],
    "spenders": [
      "0xF3dE3C0d654FDa23daD170f0f320a92172509127"
    ],
    "nonce": 1750065115100
  },
  "primaryType": "Permits",
  "types": {
    "EIP712Domain": [
      {
        "name": "name",
        "type": "string"
      },
      {
        "name": "chainId",
        "type": "uint256"
      },
      {
        "name": "verifyingContract",
        "type": "address"
      }
    ],
    "Permits": [
      {
        "name": "details",
        "type": "PermitDetails[]"
      },
      {
        "name": "spenders",
        "type": "address[]"
      },
      {
        "name": "nonce",
        "type": "uint256"
      }
    ],
    "PermitDetails": [
      {
        "name": "token",
        "type": "address"
      },
      {
        "name": "expiration",
        "type": "uint256"
      }
    ]
  }
}

ğŸ”§ å…³é”®é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ:
- é—®é¢˜: "Eip712Domain" å¯¼è‡´ "ambiguous primary types" é”™è¯¯
- è§£å†³: ç§»é™¤ types ä¸­çš„ Eip712Domainï¼Œethers.js ä¼šè‡ªåŠ¨å¤„ç†
- æ³¨æ„: å„ç§ Domain å˜ä½“éƒ½éœ€è¦ç§»é™¤ (EIP712Domain, Eip712Domain, eip712Domain)

âœ… ç­¾åç»“æœ: 
- çŠ¶æ€: æˆåŠŸ
- ç­¾ååœ°å€: 0xFCAd0B19bB29D4674531d6f115237E16AfCE377c
- éªŒè¯: é€šè¿‡

ğŸ• æµ‹è¯•æ—¶é—´: 2024-06-16 20:30

=======================================
âœ… æµ‹è¯•æ¡ˆä¾‹ #2 - (å¾…è¡¥å……)
=======================================

{
  "domain": {
    "name": "AuthTransfer",
    "chainId": 1,
    "verifyingContract": "0x40aA958dd87FC8305b97f2BA922CDdCa374bcD7f"
  },
  "message": {
    "details": [
      {
        "token": "0x0000000000000000000000000000000000000000",
        "expiration": 3242342
      }
    ],
    "spenders": [
      "0xF3dE3C0d654FDa23daD170f0f320a92172509127"
    ],
    "nonce": 1750065115100,
    "owner": "0x6f9ffea7370310cd0f890dfde5e0e061059dcfd9"
  },
  "primaryType": "Permits",
  "types": {
    "EIP712Domain": [
      {
        "name": "name",
        "type": "string"
      },
      {
        "name": "chainId",
        "type": "uint256"
      },
      {
        "name": "verifyingContract",
        "type": "address"
      },
      {
        "name": "owner",
        "type": "address"
      }
    ],
    "Permits": [
      {
        "name": "details",
        "type": "PermitDetails[]"
      },
      {
        "name": "spenders",
        "type": "address[]"
      },
      {
        "name": "nonce",
        "type": "uint256"
      }
    ],
    "PermitDetails": [
      {
        "name": "token",
        "type": "address"
      },
      {
        "name": "expiration",
        "type": "uint256"
      }
    ]
  }
}

=======================================
ğŸ“ æµ‹è¯•ç¬”è®°å’Œç»éªŒæ€»ç»“
=======================================

1. EIP712Domain å¤„ç†:
   - æ°¸è¿œä¸è¦åœ¨ types ä¸­åŒ…å«ä»»ä½•å½¢å¼çš„ Domain å®šä¹‰
   - ethers.js ä¼šæ ¹æ® domain å­—æ®µè‡ªåŠ¨ç”Ÿæˆ

2. primaryType è®¾ç½®:
   - ç¡®ä¿ primaryType åœ¨ types ä¸­å­˜åœ¨
   - é€šå¸¸æ˜¯ä½ è¦ç­¾åçš„ä¸»è¦æ•°æ®ç»“æ„

3. æ•°æ®ç±»å‹åŒ¹é…:
   - address ç±»å‹å¿…é¡»æ˜¯æœ‰æ•ˆçš„ä»¥å¤ªåŠåœ°å€æ ¼å¼
   - uint256 å¯ä»¥æ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²
   - æ•°ç»„ç±»å‹ç”¨ [] è¡¨ç¤º

4. å¸¸è§é”™è¯¯:
   - "ambiguous primary types" -> ç§»é™¤ Domain å®šä¹‰
   - "primaryType not found" -> æ£€æŸ¥ primaryType æ‹¼å†™
   - "invalid address" -> æ£€æŸ¥åœ°å€æ ¼å¼

=======================================
ğŸ”— ç›¸å…³èµ„æº
=======================================

- EIP-712 æ ‡å‡†: https://eips.ethereum.org/EIPS/eip-712
- ethers.js æ–‡æ¡£: https://docs.ethers.io/
- æœ¬åœ°æœåŠ¡å™¨: http://localhost:3000

======================================= 
